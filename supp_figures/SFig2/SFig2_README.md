# Supplementary Figure 2

This folder contains everything needed to reproduce the code-generated panels in **Supp Figure 2**, including panel-specific data and (when needed) panel-specific external code.

---

## Contents

- `SFig2.py`  
  Entry script to reproduce Supp Figure 2 (generates the figure and/or panel outputs).

- `Panel_D_data/`  
  Inputs and/or cached intermediates required for **Panel D**.

- `Panel_E_F_data/`  
  Inputs and/or cached intermediates required for **Panel D**.
---

## Environment

### Default (SimSpace)
Most of Supp Figure 2 should run in the default environment:
```bash
# Run the line below if not creating the repro env before
# conda env create -f ../../environment.yml
conda activate simspace-repro
```

---

## Run Supp Figure 2

From the repository root:
```bash
python supp_figures/SFig2/SFig2.py
```

Or from this directory:
```bash
python SFig2.py
```

---

## Panel D data

### MERFISH
External data downloaded from the study: Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region [https://www.science.org/doi/10.1126/science.aau5324].

### sccube
Generated by the scCube script `Panel_D_src/sccube.ipynb`. Also the parameters, except the random seed, are the default settings in scCube's tutorials. 
- One key thing to know that, even the random seed is fixed, scCube will still have its outputs with randomness due to CPU/GPU choice or CUDA version. To best overcome this issue, we computed 9 replicates to avoid cherry-picking issue.

### scMultiSim
Generated by the scMultiSim script `Panel_D_src/scMultiSim.R`. Also the parameters, except the random seed, are the default settings in scMultiSim's tutorials. 

### SRTsim
Generated by the SRTsim script `Panel_D_src/SRTsim.R`. 
- SRTsimâ€™s reference-free workflow differs fundamentally from the others: rather than providing a programmatic procedure to generate diverse cell-type spatial patterns, it requires a human-in-the-loop drawing/interaction process to specify cell-type distributions. This makes it difficult to (i) generate patterns at scale in a standardized way, and (ii) reproduce results precisely across users. In our study, we made a best-effort attempt to manually define spatial distributions with as much detail as feasible, but the outcome necessarily depends on manual input and is therefore not directly comparable to fully algorithmic reference-free generators.
- Therefore, the script just provides the interface of SRTsim reference-free mode. To check our simulated SRTsim data, one can load them in SRTsim's interface as well.

### Xenium
External data downloaded from the study: High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis [https://www.nature.com/articles/s41467-023-43458-x].

---

## Panel E F data

### MERFISH_meta.csv
External data downloaded from the study: Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region [https://www.science.org/doi/10.1126/science.aau5324].

### cells.csv, cell_annotation.csv
External data downloaded from the study: High resolution mapping of the tumor microenvironment using integrated single-cell, spatial and in situ analysis [https://www.nature.com/articles/s41467-023-43458-x].